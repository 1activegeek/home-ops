---
# ReferenceGrant allows SecurityPolicy resources to reference the Authentik service
# for forward-auth across namespaces
#
# Allows:
# - Gateway-level SecurityPolicy in network namespace (default auth)
# - HTTPRoute-level SecurityPolicy in app namespaces (per-route overrides)
#
apiVersion: gateway.networking.k8s.io/v1beta1
kind: ReferenceGrant
metadata:
  name: authentik-extauth
  namespace: security
spec:
  from:
    - group: gateway.envoyproxy.io
      kind: SecurityPolicy
      namespace: network  # Gateway-level default policy
    - group: gateway.envoyproxy.io
      kind: SecurityPolicy
      namespace: home  # Per-route overrides in app namespaces
  to:
    - group: ""
      kind: Service
      name: authentik-server
